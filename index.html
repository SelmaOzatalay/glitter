<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />

    <title>Glitter effect</title>
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300|Sonsie+One"
      rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <canvas id="bg-canvas"></canvas>
    <nav>
      <button onclick="setColor('blue')" data-color="blue" class="button-blue selected">blue</button>
      <button onclick="setColor('pink')" data-color="pink" class="button-pink">pink</button>
      <button onclick="setColor('green')" data-color="green" class="button-green">green</button>
      <!-- <p>
        Current color: <span id="current-color">blue</span>
      </p> -->
    </nav>
    <main>
      <h1>Glitter !</h1>
    </main>
    <canvas id="sparkles-canvas"></canvas>
  </body>
  <script>

    let currentColor = 'blue'
    const buttons = document.getElementsByTagName('nav')[0].getElementsByTagName('button')
    

    function setColor(color) {
      console.log(color)
      const colorWrapper = document.getElementById('current-color');
      currentColor = color;
      console.log(buttons)
      for (let i = 0; i <= buttons.length; i++) {
        buttons[i].classList.remove('selected')
        // if (buttons[i].classList)
      }
      // colorWrapper.innerHTML = color;
    }

    function getRandomInt(max) {
      return Math.floor(Math.random() * max);
    }


    function drawBg() {

      const canvas = document.getElementById("bg-canvas");

      if (canvas.getContext) {

        const ctx = canvas.getContext("2d");
        const [w,h] = [window.innerWidth, window.innerHeight]
        const nbParticles = window.innerWidth*100;

        ctx.canvas.width  = w;
        ctx.canvas.height = h;

        const gradient = ctx.createLinearGradient(0, 0, w, h);

        gradient.addColorStop(0, "#012452");
        gradient.addColorStop(0.25, "#0259a1");
        gradient.addColorStop(0.5, "#012452");
        gradient.addColorStop(0.75, "#0259a1");
        gradient.addColorStop(1, "#012452");

        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, w, h);

        for (var i = 0; i < nbParticles; i++) {
          const randomX = getRandomInt(w);
          const randomY = getRandomInt(h);
          ctx.fillStyle = 'blue';
          ctx.fillRect(randomX, randomY, 1, 1);
        }

        for (var i = 0; i < nbParticles; i++) {
          const randomX = getRandomInt(w);
          const randomY = getRandomInt(h);
          ctx.fillStyle = '#0080ff';
          ctx.fillRect(randomX, randomY, 1, 1);
        }

        for (var i = 0; i < nbParticles; i++) {
          const randomX = getRandomInt(w);
          const randomY = getRandomInt(h);
          ctx.fillStyle = 'rgba(125, 229, 250, 0.2)';
          ctx.fillRect(randomX, randomY, 2, 2);
        }           

      }
    }

    function drawSparkles() {

        const canvas = document.getElementById("sparkles-canvas");

        if (canvas.getContext) {

            const ctx = canvas.getContext("2d");
            const [w,h] = [window.innerWidth, window.innerHeight]
            const nbParticles = 500;

            ctx.canvas.width  = w;
            ctx.canvas.height = h;

            setInterval(()=>{

                const randomX = getRandomInt(w);
                const randomY = getRandomInt(h);
                ctx.fillStyle = 'white';

                ctx.fillRect(randomX, randomY, 1, 1);

                  const randomX2 = getRandomInt(w);
                  const randomY2 = getRandomInt(h);
                  ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';

                  ctx.fillRect(randomX2, randomY2, 2, 2);
                
                  const randomX3 = getRandomInt(w);
                  const randomY3 = getRandomInt(h);
                  ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';

                  ctx.fillRect(randomX3, randomY3, 3, 3);

                setTimeout(()=>{
                  ctx.clearRect(randomX, randomY, 1, 1);
                  ctx.clearRect(randomX2, randomY2, 2, 2);
                  ctx.clearRect(randomX3, randomY3, 3, 3);
                },1000)

            },1)

        }
    }

    window.addEventListener("load", ()=>{
      drawBg();
      window.requestAnimationFrame(drawSparkles)
    });
  </script>
</html>
